Sub Ramiris_import()

Sheets("Ramiris").Select
Range("A1").Select


'1.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=0&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$1"))
'        .CommandType = 0
        .Name = _
        "1.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'2.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=6000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$6002"))
'        .CommandType = 0
        .Name = _
        "2.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'3.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=12000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$12003"))
'        .CommandType = 0
        .Name = _
        "3.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'4.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=18000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$18004"))
'        .CommandType = 0
        .Name = _
        "4.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'5.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=24000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$24005"))
'        .CommandType = 0
        .Name = _
        "5.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'6.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=30000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$30006"))
'        .CommandType = 0
        .Name = _
        "6.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'7.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=36000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$36007"))
'        .CommandType = 0
        .Name = _
        "7.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'8.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=42000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$42008"))
'        .CommandType = 0
        .Name = _
        "8.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'9.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=48000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$48009"))
'        .CommandType = 0
        .Name = _
        "9.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'10.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=54000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$54010"))
'        .CommandType = 0
        .Name = _
        "10.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'11.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=60000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$60011"))
'        .CommandType = 0
        .Name = _
        "11.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'12.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=66000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$66012"))
'        .CommandType = 0
        .Name = _
        "12.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   
  '13.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=72000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$72013"))
'        .CommandType = 0
        .Name = _
        "13.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With

  '14.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=78000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$78014"))
'        .CommandType = 0
        .Name = _
        "14.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With

  '15.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=84000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$84015"))
'        .CommandType = 0
        .Name = _
        "15.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With

   '16.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=90000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$90016"))
'        .CommandType = 0
        .Name = _
        "16.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
       
       
  '17.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=96000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$96017"))
'        .CommandType = 0
        .Name = _
        "17.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
       
       
  '18.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=102000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$102018"))
'        .CommandType = 0
        .Name = _
        "18.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
       
End Sub
        
Sub Ramiris_szamitasok()

Sheets("Ramiris").Select

utsorB = Range("B1").End(xlDown).Row


'E oszlop PN helyrerakása
 'Columns("E:E").Select
'   Selection.TextToColumns Destination:=Range("E1"), DataType:=xlFixedWidth, _
 '       FieldInfo:=Array(0, 1), TrailingMinusNumbers:=True
   
        
'H oszlop helyrerakása
    Columns("H:H").Select
    Selection.Replace What:="-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=" ", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.NumberFormat = "0"

'Oszlopnevek
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "Darabteli PN"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "Párosítás"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "ELL"
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "ELL Gyártó"
    Range("N1").Select
    ActiveCell.FormulaR1C1 = "Kat X"
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "Termék X"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "Ram Kat"
    Range("Q1").Select
    ActiveCell.FormulaR1C1 = "Jó?"
    Range("R1").Select
    ActiveCell.FormulaR1C1 = "Inf Főkat"
    Range("S1").Select
    ActiveCell.FormulaR1C1 = "Inf Alkat"
    
    
    
'Második sor függvényei
    Range("J2").Select
    ActiveCell.FormulaR1C1 = "=COUNTIF(R2C5:R900000C5,RC[-5])"
    Range("J2").AutoFill Destination:=Range("J2:J" & utsorB)
    
    Range("K2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(CONCATENATE(""setPair("",RC[-10],"","",INDEX(Hydra!R2C1:R900000C5,MATCH(RC[-6],Hydra!R2C5:R900000C5,0),1),"",8);""),"""")"
    Range("K2").AutoFill Destination:=Range("K2:K" & utsorB)
    
    
    Range("L2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR((IF(RC[-8]=(INDEX(Hydra!R2C1:R900000C5,MATCH(RC[-7],Hydra!R2C5:R900000C5,0),2)),CONCATENATE(""setPair("",RC[-11],"","",INDEX(Hydra!R2C1:R900000C5,MATCH(RC[-7],Hydra!R2C5:R900000C5,0),1),"",8);""),""ELL"")),"""")"
    Range("L2").AutoFill Destination:=Range("L2:L" & utsorB)
    
    
    Range("M2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR((INDEX(Hydra!R2C1:R900000C5,MATCH(RC[-8],Hydra!R2C5:R900000C5,0),2)),"""")"
    Range("M2").AutoFill Destination:=Range("M2:M" & utsorB)
    
    
    Range("N2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF((MATCH(RC[2],KatX!R2C1:R90000C1,0))>0,""X"",""""),"""")"
    Range("N2").AutoFill Destination:=Range("N2:N" & utsorB)
    
    
    Range("O2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF((MATCH(RC[-14],X!R1C1:R90000C1,0))>0,""X"",""""),"""")"
    Range("O2").AutoFill Destination:=Range("O2:O" & utsorB)
    
    
    Range("P2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(CONCATENATE((INDEX(Ram_HIV!R2C1:R90000C16,MATCH(Ramiris!RC[-14],Ram_HIV!R2C3:R90000C3,0),1)),"" > "",INDEX(Ram_HIV!R2C1:R90000C16,MATCH(Ramiris!RC[-14],Ram_HIV!R2C3:R90000C3,0),2)),"""")"
    Range("P2").AutoFill Destination:=Range("P2:P" & utsorB)
    
    
    Range("Q2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-3]<>""X"",RC[-4]<>""X"",RC[-7]=""1"",RC[-9]>200,RC[-8]="""",RC[-6]=""""),""JÓ"","""")"
    Range("Q2").AutoFill Destination:=Range("Q2:Q" & utsorB)
    
    
    Range("R2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(INDEX(KAT!R2C1:R90000C3,MATCH(Ramiris!RC[-2],KAT!R2C1:R90000C1,0),2),"""")"
    Range("R2").AutoFill Destination:=Range("R2:R" & utsorB)
    
    
    Range("S2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(INDEX(KAT!R2C1:R90000C3,MATCH(Ramiris!RC[-3],KAT!R2C1:R90000C1,0),3),"""")"
    Range("S2").AutoFill Destination:=Range("S2:S" & utsorB)
    
    
    
End Sub


Sub Ramiris_beillesztés()


Columns("J:S").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End Sub

