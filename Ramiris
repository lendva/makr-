Sub Ramiris_import()
Sheets("Ramiris").Select

   Range("A1").Select
'1.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=0&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$1"))
'        .CommandType = 0
        .Name = _
        "1.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'2.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=6000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$6002"))
'        .CommandType = 0
        .Name = _
        "2.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'3.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=12000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$12003"))
'        .CommandType = 0
        .Name = _
        "3.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'4.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=18000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$18004"))
'        .CommandType = 0
        .Name = _
        "4.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'5.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=24000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$24005"))
'        .CommandType = 0
        .Name = _
        "5.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'6.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=30000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$30006"))
'        .CommandType = 0
        .Name = _
        "6.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'7.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=36000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$36007"))
'        .CommandType = 0
        .Name = _
        "7.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'8.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=42000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$42008"))
'        .CommandType = 0
        .Name = _
        "8.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'9.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=48000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$48009"))
'        .CommandType = 0
        .Name = _
        "9.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'10.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=54000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$54010"))
'        .CommandType = 0
        .Name = _
        "10.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'11.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=60000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$60011"))
'        .CommandType = 0
        .Name = _
        "11.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
'12.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=66000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$66012"))
'        .CommandType = 0
        .Name = _
        "12.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   
  '13.oldal
    ActiveWindow.SmallScroll Down:=9
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.informateka.hu/_hydra/admin-partner-termekek.php?offset=72000&limit=6000&filter=&orderby=&dir=1&partnerID=8" _
        , Destination:=Range("$A$72013"))
'        .CommandType = 0
        .Name = _
        "13.oldal"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With


        


utsorB = Range("B1").End(xlDown).Row


'E oszlop PN helyrerakása
 Columns("E:E").Select
    Selection.TextToColumns Destination:=Range("E1"), DataType:=xlFixedWidth, _
        FieldInfo:=Array(0, 1), TrailingMinusNumbers:=True

'J1 oszlopnév "Darabteli PN"
Range("J1").Select
ActiveCell.FormulaR1C1 = "Darabteli PN"
        
'Darabteli PN függvény futtatása J2-től
Range("J2").Select
ActiveCell.FormulaR1C1 = "=COUNTIF(R2C5:R900000C5,RC[-5])"
Range("J2").AutoFill Destination:=Range("J2:J" & utsorB)

' Függvény értékként való beillesztése
Columns("J:J").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        

'Nincs párosítva, Darabteli PN=1
 '   Selection.AutoFilter
 
     Columns("H:H").Select
    Selection.Replace What:=",-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
        
    ActiveSheet.Range("$A$1:$J$900000").AutoFilter Field:=9, Criteria1:="="
    ActiveSheet.Range("$A$1:$J$900000").AutoFilter Field:=10, Criteria1:="1"
    ActiveSheet.Range("$A$1:$J$900000").AutoFilter Field:=8, Criteria1:=">0", _
        Operator:=xlAnd

'Ram_A oldalra átmásolás
    Cells.Select
    Selection.Copy
    Sheets("Ram_A").Select
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False


    
'Párosítás függvény
Range("K2").Select
ActiveCell.FormulaR1C1 = _
        "=IFERROR((IF(RC[-7]=(INDEX(Hydra!R2C1:R900000C5,MATCH(Ram_A!RC[-6],Hydra!R2C5:R900000C5,0),2)),CONCATENATE(""setPair("",RC[-10],"","",INDEX(Hydra!R2C1:R900000C5,MATCH(Ram_A!RC[-6],Hydra!R2C5:R900000C5,0),1),"",8);""),""ELL"")),"""")"

Range("K2").Select
Selection.AutoFill Destination:=Range("K2:K" & utsorB)

  
  
' Függvény értékként való beillesztése
Columns("K:K").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
'------------------ RAM_B ---------------
' Raktár=1 és nincs ELL vagy párosítás benne

    ActiveSheet.Range("$A$1:$K$900000").AutoFilter Field:=7, Criteria1:="1"
    ActiveSheet.Range("$A$1:$K$900000").AutoFilter Field:=11, Criteria1:="="
    Cells.Select
    Selection.Copy
    Sheets("Ram_B").Select
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False


'Oszlopok törlése (I,J,K oszlop)
    Columns("I:K").Select
    Selection.Delete Shift:=xlToLeft
    
'Kategória függvények
    Range("I2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(INDEX(Ram_HIV!R2C1:R900000C6,MATCH(Ram_B!RC[-6],Ram_HIV!R2C3:R900000C3,0),1),"""")"
    Range("I2").Select
    Selection.AutoFill Destination:=Range("I2:I" & utsorB)

    Range("J2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(INDEX(Ram_HIV!R2C1:R900000C6,MATCH(Ram_B!RC[-7],Ram_HIV!R2C3:R900000C3,0),2),"""")"
    Range("J2").Select
    Selection.AutoFill Destination:=Range("J2:J" & utsorB)
    

'Függvény értékként való beillesztése
Columns("I:I").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
Columns("J:J").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
 
   
'Kategória nevek összefűzése
    Range("K2").Select
    ActiveCell.FormulaR1C1 = "=CONCATENATE(RC[-2],"" > "",RC[-1])"
    Range("K2").Select
    Selection.AutoFill Destination:=Range("K2:K" & utsorB)
    
'Függvény értékként való beillesztése
Columns("K:K").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

        
'Oszlopok törlése
    Columns("I:J").Select
    Selection.Delete Shift:=xlToLeft
    
'Oszlop elnevezése
Range("I1").Select
ActiveCell.FormulaR1C1 = "Ramiris Kat"
Range("J1").Select
ActiveCell.FormulaR1C1 = "Kat szűrés"
Range("K1").Select
ActiveCell.FormulaR1C1 = "INF Főkat"
Range("L1").Select
ActiveCell.FormulaR1C1 = "INF Alkat"

'Kategória szűrés
    Range("J2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF((MATCH(RC[-1],Ram_X!R1C1:R9000C1,0))>0,""x"",""""),"""")"
    Range("J2").Select
    Selection.AutoFill Destination:=Range("J2:J" & utsorB)
    
'Függvény értékként való beillesztése
Columns("J:J").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    

utsorB = Range("B1").End(xlDown).Row
'INF Főkat függvény
    Range("K2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(INDEX(Ram_Kat!R1C1:R9000C3,MATCH(Ram_B!RC[-2],Ram_Kat!R1C1:R9000C1,0),2),"""")"
    Range("K2").Select
    Selection.AutoFill Destination:=Range("K2:K" & utsorB)
    
'Függvény értékként való beillesztése
Columns("K:K").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    
'INF Alkat függvény
    Range("L2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(INDEX(Ram_Kat!R1C1:R9000C3,MATCH(Ram_B!RC[-3],Ram_Kat!R1C1:R9000C1,0),3),"""")"
    Range("L2").Select
    Selection.AutoFill Destination:=Range("L2:L" & utsorB)
    
'Függvény értékként való beillesztése
Columns("L:L").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
'Nullák kitörlése
    Columns("K:K").Select
    Selection.Replace What:="0", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Columns("L:L").Select
    Selection.Replace What:="0", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
' Feltöltendő elemek szűrése
    ActiveSheet.Range("$A$1:$L$900000").AutoFilter Field:=11, Criteria1:="<>", _
        Operator:=xlAnd
    Cells.Select
    Range("K4").Activate
    Selection.Copy
    Sheets("Ram_C").Select
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
            Application.CutCopyMode = False
            
'Oszlopok elnevezése
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "Főkat ID"
    Range("N1").Select
    ActiveCell.FormulaR1C1 = "Alkat ID"
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "Gyártó ID"
    
'Gyártó ID Függvény
    Range("O2").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(Gyártó_ID!R1C1:R90000C2,MATCH(Ram_C!RC[-11],Gyártó_ID!R1C1:R90000C1,0),2)"
     Range("O2").Select
    Selection.AutoFill Destination:=Range("O2:O" & utsorB)
    
End Sub
